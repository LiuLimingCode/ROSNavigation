<?xml version="1.0"?>
<launch>

  <arg name="enable_odom_tf" default="false"/>
  <arg name="odom_frame" default="odom"/>
  <arg name="odom_topic" default="odom"/>
  <arg name="cmd_topic" default="cmd_vel"/>

  <arg name="model_file" default="$(find racecar_description)/urdf/racecar_robot.xacro"/>

  <param name="robot_description" command="$(find xacro)/xacro $(arg model_file) --inorder  enable_odom_tf:=$(arg enable_odom_tf) odom_frame:=$(arg odom_frame) odom_topic:=$(arg odom_topic) cmd_topic:=$(arg cmd_topic)"/>
  <node name="urdf_spawner" pkg="gazebo_ros" type="spawn_model" output="screen" args="-urdf -model racecar -param robot_description"/>
  
  <!-- ros_control racecar launch file -->
  <include file="$(find racecar_control)/launch/racecar_control.launch" ns="/"/>

  <!-- Spawn the MUXs -->
  <arg name="racecar_version" default="racecar-v2" />
  <include file="$(find racecar)/launch/mux.launch" ns="vesc"/>

  <!-- Publish "better odom" topic that is normally generated by the particle filter -->
  <node name="better_odom" pkg="topic_tools" type="relay"
          args="/vesc/odom /pf/pose/odom" />
    
  <!--Launch the simulation joystick control-->
  <rosparam command="load" file="$(find racecar_gazebo)/config/keyboard_teleop.yaml" />
  <node pkg="racecar_gazebo" type="keyboard_teleop.py" name="keyboard_teleop" />


</launch>

